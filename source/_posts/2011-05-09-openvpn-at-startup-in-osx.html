---
layout: post
title: OpenVPN at startup in OSX
tags:
- mac
- openvpn
- osx
- tunnelblick
- vpn
status: publish
type: post
published: true
meta:
  _edit_last: '1'
---
The easiest way of getting an OpenVPN client on mac is with <a href="http://code.google.com/p/tunnelblick/wiki/DownloadsEntry?tm=2" target="_blank">Tunnelblick</a> but you will join the VPN only when you have logged in. Sometimes you need your mac to connect at startup instead and I'll show you how to do it:

create /etc/rc.local and copy/paste the following three lines in it:


```

#!/bin/bash
/sbin/kextload /Applications/Tunnelblick.app/Contents/Resources/tap.kext
/sbin/kextload /Applications/Tunnelblick.app/Contents/Resources/tun.kext
```



then create a Launch script like this for each of the vpn you want to connect to, replacing <em>YOURVPNNAME</em>, <em>YOURCONFIGFILE</em>, <em>YOUR/CONFIG/FOLDER</em> accordingly:


```

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
&lt;key&gt;Label&lt;/key&gt;
&lt;string&gt;org.openvpn.YOURVPNNAME&lt;/string&gt;
&lt;key&gt;OnDemand&lt;/key&gt;
&lt;false/&gt;
&lt;key&gt;Program&lt;/key&gt;
&lt;string&gt;/Applications/Tunnelblick.app/Contents/Resources/openvpn&lt;/string&gt;
&lt;key&gt;ProgramArguments&lt;/key&gt;
&lt;array&gt;
&lt;string&gt;openvpn&lt;/string&gt;
&lt;string&gt;--config&lt;/string&gt;
&lt;string&gt;YOURCONFIGFILE.conf&lt;/string&gt;
&lt;/array&gt;
&lt;key&gt;RunAtLoad&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;TimeOut&lt;/key&gt;
&lt;integer&gt;90&lt;/integer&gt;
&lt;key&gt;WorkingDirectory&lt;/key&gt;
&lt;string&gt;YOUR/CONFIG/FOLDER&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
```



save each script into <em>/Library/LaunchDaemons/</em> folder using a name for the file like <em>org.openvpn.YOURVPNNAME.plist</em>, then change the user and group to root:wheel with the following command in a terminal window:


```

sudo chown root:wheel /Library/LaunchDaemon/org.openvpn.YOURVPNNAME
```


last commands to register and execute your Launch scripts are:


```

sudo launchctl load /Library/LaunchDaemon/org.openvpn.YOURVPNNAME.plist
sudo launchctl start org.openvpn.YOURVPNNAME
```



a restart should be the very last thing to do and once your mac has started you shoud be connected to your vpn network(s)!

enjoy ;)

<strong>UPDATE: </strong>the new version of tunnelblick 3.2beta26 does have the the "connect when computer starts" functionality that automatically makes this post obsolete. I'll just keep it for the records :)
